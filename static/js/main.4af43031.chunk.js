(this["webpackJsonprap-winds-aloft"]=this["webpackJsonprap-winds-aloft"]||[]).push([[0],{19:function(e){e.exports=JSON.parse('{"revision":"4ad90626"}')},26:function(e,t,n){},27:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(1),i=n.n(c),o=n(18),a=n.n(o),s=(n(26),n(9)),l=n(2),d=(n(27),n(19)),u=function(){return Object(r.jsx)("button",{className:"menu icon","aria-label":"Menu",children:Object(r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",children:[Object(r.jsx)("defs",{children:Object(r.jsx)("rect",{id:"bar",width:"256",height:"48",rx:"16"})}),Object(r.jsx)("use",{href:"#bar",transform:"translate(0, 16)"}),Object(r.jsx)("use",{href:"#bar",transform:"translate(0, 96)"}),Object(r.jsx)("use",{href:"#bar",transform:"translate(0, 176)"})]})})},j=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",children:Object(r.jsx)("path",{className:"arrow",d:"M 128 24 L 18 128 L 128 232",fill:"none",stroke:"var(--highlight-color)",strokeWidth:"48",strokeLinejoin:"round",strokeLinecap:"round",transform:"translate(48,0)"})})},h=function(){var e=Object(l.g)(),t=Object(l.f)();return Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)("div",{children:"/"===e.pathname?Object(r.jsx)(s.b,{to:"/menu","aria-label":"Menu",children:Object(r.jsx)(u,{})}):Object(r.jsx)("button",{onClick:function(){return t.goBack()},className:"icon","aria-label":"Back",children:Object(r.jsx)(j,{})})}),Object(r.jsx)("div",{className:"title",children:"/"===e.pathname?"Winds Aloft":e.pathname.replace(/^\//,"").replace(/[^]/,(function(e){return e.toUpperCase()}))}),Object(r.jsxs)("div",{children:["Build: ",d.revision]})]})},b=(n(33),function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",children:Object(r.jsx)("path",{className:"arrow",d:"M 128 24 L 18 128 L 128 232",fill:"none",strokeWidth:"48",strokeLinejoin:"round",strokeLinecap:"round",transform:"rotate(180, 128 128) translate(48,0)"})})}),f=function(){var e=Object(l.f)();return Object(r.jsxs)("ul",{className:"Menu",children:[Object(r.jsxs)("li",{onClick:function(){return t="/about",void e.push(t);var t},children:[Object(r.jsx)("div",{children:"About"}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"icon","aria-label":"About",children:Object(r.jsx)(b,{})})})]}),Object(r.jsxs)("li",{onClick:function(){sessionStorage.removeItem("cache"),e.goBack()},children:[Object(r.jsx)("div",{children:"Clear Cache"}),Object(r.jsx)("button",{className:"icon","aria-label":"Clear Cache",children:Object(r.jsx)(b,{})})]})]})},v=(n(34),function(){return Object(r.jsxs)("div",{className:"About",children:[Object(r.jsx)("h1",{children:"About"}),Object(r.jsxs)("p",{children:["Display a current winds aloft forecast from"," ",Object(r.jsx)("a",{href:"https://rucsoundings.noaa.gov/",target:"_blank",rel:"noopener noreferrer",children:"rucsoundings.noaa.gov"}),"."]}),Object(r.jsx)("p",{children:"Your location is determined using your device's location service. The ground elevation and winds aloft forecast for your location are fetched from online services. The forecast data is cached on your device until the start of each hour, and refetched after that."}),Object(r.jsx)("p",{children:"Reported altitudes are Above Ground Level (AGL). A future option may allow the choice do display altitudes above Mean Sea Level (MSL)."}),Object(r.jsxs)("p",{children:[Object(r.jsx)("span",{className:"warning",children:"PLEASE NOTE:"})," This app probably only works correctly in the United States, as it uses NOAA and USGS services to gather data."]}),Object(r.jsx)("h2",{children:"Future plans"}),Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:"Integrate map service to fine-tune location"}),Object(r.jsx)("li",{children:"Provide preference option to view metric or imperial units"}),Object(r.jsx)("li",{children:"Provide preference option for light or dark theme"})]}),Object(r.jsx)("h2",{children:"Contact"}),Object(r.jsx)("p",{children:"David Rose (doppler@gmail.com)"}),Object(r.jsx)("p",{children:Object(r.jsx)("a",{href:"https://facebook.com/doppler",target:"_blank",rel:"noopener noreferrer",children:"Facebook"})})]})}),p=n(10),O=n.n(p),g=n(16),x=n(11),m=n.p+"static/media/Loading.1831e8a7.svg",w=function(e){var t=e.dir;return Object(r.jsxs)("svg",{viewBox:"0 0 512 512",height:"2em",width:"2em",children:[Object(r.jsx)("circle",{id:"ring",cx:"256",cy:"256",r:"237.32505032019532",stroke:"var(--highlight-color)",strokeWidth:"37.349899359609346"}),Object(r.jsx)("path",{id:"arrow",d:" M 260.4 0 L 269.56814539771983 274.6749500197458 L 313.475583094649 335.1083534400135 L 256 512 L 198.52441690535102 335.1083534400135 L 242.43185460228014 274.6749500197458 L 251.6 0 Z",fill:"var(--warning-color)",transform:"rotate(".concat(t,", 256, 256)")})]})},k={latitude:0,longitude:0},L=function(){var e=Object(c.useState)(k),t=Object(x.a)(e,2),n=t[0],i=t[1],o=Object(c.useState)(0),a=Object(x.a)(o,2),s=a[0],l=a[1],d=Object(c.useState)(null),u=Object(x.a)(d,2),j=u[0],h=u[1],b=Object(c.useState)("Loading..."),f=Object(x.a)(b,2),v=f[0],p=f[1],L=function(e){i({latitude:Number(e.coords.latitude.toFixed(7)),longitude:Number(e.coords.longitude.toFixed(7))})};return Object(c.useEffect)((function(){navigator.geolocation.getCurrentPosition(L)}),[]),Object(c.useEffect)((function(){var e=JSON.parse(sessionStorage.getItem("cache")||"null");e&&(h(e),l(null===e||void 0===e?void 0:e.elevation))}),[]),Object(c.useEffect)((function(){var e=setInterval((function(){j&&(new Date).getUTCHours()===j.hour&&(console.log("clearing cache"),sessionStorage.removeItem("cache"),h(null))}),6e4);return function(){return clearInterval(e)}}),[j]),Object(c.useEffect)((function(){if(!s&&n.latitude){var e=new AbortController;return function(){var t=Object(g.a)(O.a.mark((function t(n){var r,c,i,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("fetching elevation"),t.prev=1,p("Determining location elevation..."),r=Object.entries({x:n.longitude,y:n.latitude,units:"Meters",output:"json"}).map((function(e){return e.join("=")})).join("&"),c="https://nationalmap.gov/epqs/pqs.php?".concat(r),t.next=7,fetch(c,{signal:e.signal});case 7:return i=t.sent,t.next=10,i.json();case 10:o=t.sent,l(o.USGS_Elevation_Point_Query_Service.Elevation_Query.Elevation),p(""),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.error(t.t0.name);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e){return t.apply(this,arguments)}}()(n),function(){return e.abort()}}}),[n,s]),Object(c.useEffect)((function(){if(!j&&s){var e=new AbortController;return function(){var t=Object(g.a)(O.a.mark((function t(n,r){var c,i,o;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("fetching winds aloft"),t.prev=1,p("Fetching winds aloft forecast data..."),c="https://weatherflow-dash.herokuapp.com/winds-aloft/".concat(n.latitude,"/").concat(n.longitude,"/").concat(r),t.next=6,fetch(c,{signal:e.signal});case 6:return i=t.sent,t.next=9,i.json();case 9:o=t.sent,h(o),sessionStorage.setItem("cache",JSON.stringify(o)),p(""),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.error(t.t0.name);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e,n){return t.apply(this,arguments)}}()(n,s),function(){return e.abort()}}}),[n,s,j]),j?Object(r.jsxs)("div",{id:"winds-aloft-chart",children:[j.soundings.map((function(e,t){return Object(r.jsxs)("div",{className:"sounding",children:[Object(r.jsxs)("div",{children:[e.altitude.feetAGL," ft."]}),Object(r.jsxs)("div",{children:[e.windSpd.mph," mph"]}),Object(r.jsx)("div",{children:Object(r.jsx)(w,{dir:e.windDir})}),Object(r.jsxs)("div",{children:[e.windDir,"\xb0"]}),Object(r.jsxs)("div",{children:[e.temp.f,"\xb0F"]})]},t)})).reverse(),Object(r.jsxs)("div",{className:"footer",children:[j.header,Object(r.jsx)("br",{}),j.op40,Object(r.jsx)("br",{}),"Elevation: ",j.elevation,"m MSL"]})]}):Object(r.jsxs)("div",{className:"Loading-indicator",children:[Object(r.jsx)("h2",{children:v}),Object(r.jsx)("img",{src:m,alt:"Loading indicator",className:"Loading-indicator-svg"})]})};var S=function(){return Object(r.jsx)(s.a,{children:Object(r.jsxs)("div",{id:"App",children:[Object(r.jsx)("div",{id:"Header",children:Object(r.jsx)(h,{})}),Object(r.jsx)("div",{id:"Main",children:Object(r.jsxs)(l.c,{children:[Object(r.jsx)(l.a,{path:"/about",children:Object(r.jsx)(v,{})}),Object(r.jsx)(l.a,{path:"/menu",children:Object(r.jsx)(f,{})}),Object(r.jsx)(l.a,{path:"/",children:Object(r.jsx)(L,{})})]})})]})})},N=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function y(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),i(e),o(e)}))};a.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(S,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rap-winds-aloft",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rap-winds-aloft","/service-worker.js");N?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):y(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):y(t,e)}))}}(),A()}},[[36,1,2]]]);
//# sourceMappingURL=main.4af43031.chunk.js.map